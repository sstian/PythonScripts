<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
    <title>Group18-PFM</title>
    <link rel="icon" href="/static/favicon.ico" type="image/ico">
    <meta name="keywords" content="PFM">
    <meta name="description" content="Tech Project – Personal Finance Manager">
    <meta name="author" content="Group18">
    <link href="/static/css/bootstrap.min.css" rel="stylesheet">
    <link href="/static/css/materialdesignicons.min.css" rel="stylesheet">
    <link href="/static/css/style.min.css" rel="stylesheet">
    <script src="https://cdn.staticfile.org/echarts/4.3.0/echarts.min.js"></script>
    <style>
        #nav11{
            width: auto;
            height: auto;
            font-family: "Times New Roman";
            color: black;
            /*margin: auto;*/
            margin-left: 30px;
            position: relative;
            left:80px;
            background-color: white;

        }
        .menu{
            font-size: 30px;
            font-family: "Times New Roman";
            color: black;
            width:500px;
            height: auto;
            line-height: 38px;
            text-align: left;
            /*color:#000;*/
            /*border-top: 1px solid #cccccc;*/
            /*border-bottom: 1px solid #cccccc;*/
            font-size: 30px;
            left:50px;
        }
        .item{

            font-size: 25px;
            font-family: "Times New Roman";
            color: black;
            width: 400px;
            height: auto;
            line-height: 38px;
            text-align: left;
            /*border-top: 1px solid #cccccc;*/
            border-bottom: 1px solid #cccccc;
            /*border-right: 1px solid #cccccc;*/
            /*border-bottom: 1px dashed #cccccc;*/
            color: #000000;
            left:30px;
            /*display: none;*/
        }
        #addCatagory{
            position: relative;
            left: 80px;
            height: 30px;
        }
        .removeButton{
            /*font-color:white;*/
            /*background-color: #bf800c;*/
        }
        .divWorld  {
            height: 50px;
            width: 200px;


        }
        #topBar :nth-child(odd) {

            background: #ccc;

        }
        #topBar :nth-child(even) {

            background-color: #8b95a5;

        }

        /*.col-lg-12{*/
        /*display: none;*/
        /*}*/
    </style>
</head>

<body>
<div class="lyear-layout-web">
    <div class="lyear-layout-container">
        <!--左侧导航-->
        <aside class="lyear-layout-sidebar">

            <!-- logo -->
            <div id="logo" class="sidebar-header">
                <a href="index.html"><img src="/static/images/citi.jpg" title="PFM" alt="PFM" /></a>
            </div>
            <div class="lyear-layout-sidebar-scroll">

                <nav class="sidebar-main">
                    <ul class="nav nav-drawer">
                        <li class="nav-item active"> <a href="index.html"><i class="mdi mdi-home"></i> Home </a> </li>
                        <li class="nav-item nav-item-has-subnav">
                            <a href="expense.html"><i class="mdi mdi-palette"></i> Expenses </a>
                            <!--<ul class="nav nav-subnav">-->
                                <!--<li> <a href="lyear_ui_buttons.html"> detail </a> </li>-->
                            <!--</ul>-->
                        </li>
                        <li class="nav-item nav-item-has-subnav">
                            <a href="javascript:void(0)"><i class="mdi mdi-file-outline"></i> Income </a>

                        </li>
                        <li class="nav-item nav-item-has-subnav">
                            <a href="javascript:void(0)"><i class="mdi mdi-language-javascript"></i> Budget </a>

                        </li>
                        <li class="nav-item nav-item-has-subnav">
                            <a href="javascript:void(0)"><i class="mdi mdi-menu"></i> Accounts </a>
                        </li>
                        <li class="nav-item nav-item-has-subnav">
                            <a href="/import.html"><i class="mdi mdi-format-align-justify"></i> Import Data </a>
                        </li>
                    </ul>
                </nav>

                <div class="sidebar-footer">
                    <p class="copyright">Copyright &copy; 2020. All rights reserved. <a href="https://www.citigroup.com/citi/" target="_blank">Citi.Group18</a></p>
                </div>
            </div>

        </aside>
        <!--End 左侧导航-->

        <!--头部信息-->
        <header class="lyear-layout-header">

            <nav class="navbar navbar-default">
                <div class="topbar">

                    <div class="topbar-left">
                        <div class="lyear-aside-toggler">
                            <span class="lyear-toggler-bar"></span>
                            <span class="lyear-toggler-bar"></span>
                            <span class="lyear-toggler-bar"></span>
                        </div>
                        <span class="navbar-page-title"> Personal Finance Manager </span>
                    </div>

                    <ul class="topbar-right">
                        <li class="dropdown dropdown-profile">
                            <a href="javascript:void(0)" data-toggle="dropdown">
                                <img class="img-avatar img-avatar-48 m-r-10" src="/static/images/users/avatar.jpg" alt="Group 18" />
                                <span>Group 18 <span class="caret"></span></span>
                            </a>
                            <ul class="dropdown-menu dropdown-menu-right">
                                <li> <a href="lyear_pages_profile.html"><i class="mdi mdi-account"></i> personal info</a> </li>
                                <li> <a href="lyear_pages_edit_pwd.html"><i class="mdi mdi-lock-outline"></i> update pwd</a> </li>
                                <li> <a href="javascript:void(0)"><i class="mdi mdi-delete"></i> clean</a></li>
                                <li class="divider"></li>
                                <li> <a href="lyear_pages_login.html"><i class="mdi mdi-logout-variant"></i> logout</a> </li>
                            </ul>
                        </li>

                    </ul>
                </div>
            </nav>
        </header>
        <!--End 头部信息-->

        <!--页面主要内容-->
        <main class="lyear-layout-content">

            <main class="lyear-layout-content">

                <div class="container-fluid">

                    <div class="row">
                        <div class="col-lg-12">
                            <div class="card">
                                <div class="card-toolbar clearfix">
                                    <form class="pull-right search-bar" method="get" action="#!" role="form">
                                        <div class="input-group">
                                            <div class="input-group-btn">
                                                <!--<input type="hidden" name="search_field" id="1search-field" value="title"-->
                                                <!--<button class="btn btn-default dropdown-toggle" id="search-btn" data-toggle="dropdown" type="button" aria-haspopup="true" aria-expanded="false">-->
                                                    <!--标题 <span class="caret"></span>-->
                                                <!--</button>-->
                                                <!--<ul class="dropdown-menu">-->
                                                    <!--<li> <a tabindex="-1" href="javascript:void(0)" data-field="title">标题</a> </li>-->
                                                    <!--<li> <a tabindex="-1" href="javascript:void(0)" data-field="cat_name">栏目</a> </li>-->
                                                <!--</ul>-->
                                            <!--</div>-->
                                            <!--<input type="text" class="form-control" value="" name="keyword" placeholder="请输入名称">-->
                                        </div>
                                        </div>
                                    </form>
                                    <!--<div class="toolbar-btn-action">-->
                                        <!--<a class="btn btn-success m-r-5" href="#!"><i class="mdi mdi-plus"></i> add catagory</a>-->
                                        <!--&lt;!&ndash;<a class="btn btn-success m-r-5" href="#!"><i class="mdi mdi-check"></i> 启用</a>&ndash;&gt;-->
                                        <!--&lt;!&ndash;<a class="btn btn-warning m-r-5" href="#!"><i class="mdi mdi-block-helper"></i> 禁用</a>&ndash;&gt;-->
                                        <!--&lt;!&ndash;<a class="btn btn-warning" href="#!"><i class="mdi mdi-window-close"></i> remove</a>&ndash;&gt;-->
                                    <!--</div>-->
                                </div>

                                <div class="card-body">

                                    <div class="table-responsive">
                                        <table class="table table-bordered">
                                            <thead>
                                            <tr>
                                                <!--<th>-->
                                                <!--<label class="lyear-checkbox checkbox-primary">-->
                                                <!--<input type="checkbox" id="check-all"><span></span>-->
                                                <!--</label>-->
                                                <!--</th>-->
                                                <th>Catagory Name</th>
                                                <th>Expense Amount</th>

                                                <th>More Details</th>
                                                <!--<th>Remove Catagory</th>-->
                                                <!--<th>transactionPrice</th>-->
                                                <!--<th>removeTransaction</th>-->
                                            </tr>
                                            </thead>
                                            <tbody id="topContent">


                                            </tbody>
                                        </table>
                                    </div>


                                </div>
                            </div>
                        </div>

                    </div>

                </div>

            </main>
            <main class="lyear-layout-content">

                <div class="container-fluid">

                    <div class="row">
                        <div class="col-lg-12">
                            <div class="card">
                                <div class="card-toolbar clearfix">
                                    <form class="pull-right search-bar" method="get" action="#!" role="form">
                                        <div class="input-group">

                                        </div>
                                    </form>
                                    <div class="toolbar-btn-action">
                                        <a class="btn btn-success m-r-5" href="addDetail.html"><i class="mdi mdi-plus"></i> add transaction</a>
                                        <!--<a class="btn btn-success m-r-5" href="#!"><i class="mdi mdi-check"></i> 启用</a>-->
                                        <!--<a class="btn btn-warning m-r-5" href="#!"><i class="mdi mdi-block-helper"></i> 禁用</a>-->
                                        <!--<a class="btn btn-warning" href="#!"><i class="mdi mdi-window-close"></i> remove</a>-->
                                    </div>
                                </div>

                                <div class="card-body">

                                    <div class="table-responsive">
                                        <table class="table table-bordered">
                                            <thead>
                                            <tr>
                                                <!--<th>-->
                                                <!--<label class="lyear-checkbox checkbox-primary">-->
                                                <!--<input type="checkbox" id="check-all"><span></span>-->
                                                <!--</label>-->
                                                <!--</th>-->
                                                <th>Transaction Name</th>
                                                <th>Transaction Date</th>

                                                <th>Transaction Detail</th>
                                                <th>Transaction Price</th>
                                                <th>Remove Item</th>
                                            </tr>
                                            </thead>
                                            <tbody id="contentBody">


                                            </tbody>
                                        </table>
                                    </div>


                                </div>
                            </div>
                        </div>

                    </div>

                </div>

            </main>
        </main>    <!--End 页面主要内容-->
    </div>

</div>


<script type="text/javascript" src="/static/js/jquery.min.js"></script>
<script type="text/javascript" src="/static/js/bootstrap.min.js"></script>
<script type="text/javascript" src="/static/js/perfect-scrollbar.min.js"></script>
<script type="text/javascript" src="/static/js/main.min.js"></script>

<!--图表插件-->
<script type="text/javascript" src="/static/js/Chart.js"></script>
<script type="text/javascript">

    // details 数据处理
    var dets = {{ details | safe }};
    var nav = [];
    var navChild = [];
    for (var det in dets) {
        if (det !== "Home/Rent")
            continue;

        var fields = dets[det];
        nav.push({
            name: fields["name"],
            price: fields["expense"].toFixed(2)});

        var subs = fields["sub"];
        for(var sub in subs) {
            var sub_fields = subs[sub];
            navChild.push({
                {#id: sub_fields["id"],#}
                name: sub_fields["detail"],
                date: sub_fields["trade_date"],
                detail: sub_fields["remark"],
                price: sub_fields["price"].toFixed(2)});
        }
    }

    {#var nav =[{name:"Home/Rent",price:2116.39},#}
    {#    {name:"Utilities",price:343.99},#}
    {#    {name:"Food/Groceries",price:420.00},#}
    {#    {name:"Departmental",price:630.35},#}
    {#    {name:"Entertainment",price:211.12}];#}
    //    动态生成上面好看的块
    var tbody = document.getElementById("topContent");
    for(var i = 0; i<nav.length;i++){
        var tr = document.createElement("tr");
        tbody.appendChild(tr);

        for(var k in nav[i]){
            var td = document.createElement("td");
            tr.appendChild(td);
            td.innerHTML = nav[i][k];
        }
        var td = document.createElement('td');
        tr.appendChild(td);
        var newBtn = document.createElement("button");
        newBtn.id="btn"+i;
        newBtn.innerHTML = "+ More Details";
        td.appendChild(newBtn);

        newBtn.className = "MoreDetailsButton";
        newBtn.onclick=function () {
            if(this.id === "btn0"){
                window.location.href="homeDetail.html";
//            window.open("homeDetail.html");
            }
            else{
                window.location.href="UtilitiesDetail.html";

            }
//       console.log(this.id);
// delete function.传入delete请求
        }







//        var td1 = document.createElement('td');
//        tr.appendChild(td1);
//        var newRemoveBtn = document.createElement("button");
//        newRemoveBtn .innerHTML = "× Remove";
//        td1.appendChild(newRemoveBtn );
//        newRemoveBtn.className = "removeButton";
//        newRemoveBtn.onclick=function () {
//
//        }
    }

    //    console.log(document.getElementById("btn0"));
    //    var detailButton = document.getElementsByClassName("MoreDetailsButton");






    //返回的小类别
    //    var navChild= [{id:"0",name:"Mortgage",parent:"Home/Rent",date:'7/12/16',price:2116.39},
    //        {id:"1",name:"Electricity",parent:"Utilities",date:'7/2/16',detail:'NYSEG',price:69.94},
    //        {id:"2",name:"CellPhone",parent:"Utilities",date:'7/7/16',detail:'AT&T Wireless',price:124.25},
    //        {id:"3",name:"Gas/Heating",parent:"Utilities",date:'7/11/16',detail:'NYSEG',price:57.73},
    //        {id:"4",name:"Internet",parent:"Utilities",date:'7/16/16',detail:'Road Runner',price:43.28},
    //        {id:"5",name:"Water",parent:"Utilities",date:'7/23/16',detail:'Aqua America',price:48.79}];
    {#var navChild= [{name:"Mortgage",date:'7/12/16',detail:"null",price:2116.39}];#}
    //    动态生成表格
    var tbody = document.getElementById("contentBody");
    for(var i = 0; i<navChild.length;i++){
        var tr = document.createElement("tr");
        tbody.appendChild(tr);

        for(var k in navChild[i]){
            {#if (k === "id")#}
            {#    continue;#}
            var td = document.createElement("td");
            tr.appendChild(td);
            td.innerHTML = navChild[i][k];
        }
        var td = document.createElement('td');
        tr.appendChild(td);
        var newBtn = document.createElement("button");
        newBtn.innerHTML = "× Remove";
        td.appendChild(newBtn);
        newBtn.id="Remove"+navChild[i].name;
        newBtn.className = "removeButton";
        newBtn.name = navChild[i].name;
        newBtn.onclick=function () {
//            delete function.传入delete请求
            //            remove的Transcation名字
            // alert("id = " +  this.trade_id);
            // alert("id = " +  this.trade_id);
            var removeTest = this.id.substring(6,this.id.length);
            console.log(removeTest);

            $.ajax({
            url: "/removeTrade",
            type: "post",
            data: {category_name: "Home/Rent",
                detail: this.name
            },
            success: function (data) {
                // 成功：{"res“: 1}
                // 失败：{"res“: 0}
                if (data.res === 1) {
                    // 页面跳转
                    // $.alert('Remove Success ' );
                    // location.href = "/" + transactionObj.catagoryName + "Detail";
                    location.href = "/expense";
                    // window.history.back();
                    // location.reload();
                } else {
                    // 显示提示信息
                   // $.alert('Remove Faied! ' );
                }
                //alert("submit 2");
            }
        });

        }
    }
    // console.log(nav.length);
    //console.log(menuItem.length);
    //    function loadNav() {
    //
    //        var len = nav.length;
    //
    //        console.log(len);
    //        console.log(navChild.length);
    //        var text = [];
    //
    //        for(var i=0;i<len;i++){
    //            var menuId=nav[i].id;
    ////      创建div
    //            var menu = document.createElement("ul");
    //            menu.className = 'menu';
    //            document.getElementById("nav1").appendChild(menu);
    //            menu.innerHTML = "<a href= # ,class='current''>"+nav[i].name+"&nbsp"+nav[i].price+"</a>";
    //
    ////            menu.innerHTML=nav[i].name+"&nbsp"+nav[i].price;
    ////        html.push("<li><a href='"+nav[i].href+"'>"+nav[i].name+"</a></li>")
    ////      console.log(i);
    ////          处理二级菜单
    ////      console.log(menuItem.length);
    ////            for(var j=0;j<navChild.length;j++){
    ////                if(nav[i].name == navChild[j].parent){
    ////                    text[j]=navChild[j].id;
    //////          var menuItem = document.createElement("div");
    ////                    var menuItem = document.createElement("li")
    ////                    menuItem.className = "item";
    ////                    menu.appendChild(menuItem);
    ////
    ////                    menuItem.innerHTML = navChild[j].name+"<br>"+navChild[j].date+"&nbsp"+navChild[j].detail+"&nbsp"+navChild[j].price;
    ////                }
    ////            }
    //        }
    //
    //    }
    //    window.onload = loadNav();

    //document.getElementsByClassName("menu").onclick = function () {
    //    document.getElementsByClassName("col-lg-12").display = "block";
    //}
    //    $(function(){
    //        $(".menu > .col-lg-12").click(function(){
    //            $(this).next().toggle(400,function(){
    //                //TODO
    //            });
    //
    //        });
    //    });



    //    var tmpCatagory ;
    //    document.getElementById("addCatagory").onclick=function () {
    //        var tmpCatagory = window.prompt("please input an catagory name",'');
    ////     alert(tmpCatagory);
    ////    var menu = document.createElement("div");
    //        var menu = document.createElement("ul");
    //        menu.className = 'menu';
    //        document.getElementById("nav11").appendChild(menu);
    //        menu.innerHTML=tmpCatagory+"&nbsp"+"0";
    //
    //    }
    //    nav.push({name:tmpCatagory,price:0});


    //document.getElementById("btn").onclick = function () {
    //    var sourceNode = document.getElementById("test");
    //    var cloneNode = sourceNode.cloneNode(true);
    //    cloneNode.setAttribute("h6 text-white m-t-0","Acc");
    //    cloneNode.setAttribute("h3 text-white m-b-0",'123');
    //    sourceNode.parentNode.appendChild(cloneNode); };



</script>
</body>
</html>
